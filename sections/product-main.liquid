<section class="product-main">
  <div class="content-wrapper">
    <div class="product-images">
      <div class="media-wrapper">
        <img src="{{ product.featured_image | img_url: '1500x' }}" alt="{{ product.title }}">
      </div>
      <div class="media-controls">
        <div class="swiper">
          <div class="swiper-wrapper">
            {% for image in product.images %}
              <div class="swiper-slide">
                <div class="slide-wrapper">
                  <img src="{{ image.src | img_url: '1000x' }}" alt="{{ product.title }}">
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>

    </div>
    <div class="product-info">
      <h1>{{ product.title }}</h1>
      <div class="price-wrapper">
        <h3 class="price">{{ product.price | money }}</h3>
        {% if product.compare_at_price %}
          <h4><s>{{ product.compare_at_price | money }}</s></h4>
        {% endif %}
      </div>
      <div class="bottlenexus-wrapper">
        {{ product.metafields.custom.bottlenexus_code }}
      </div>
      <div class="description">
        {{ product.description }}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Main",
  "settings": [],
  "presets": [
    {
      "name": "Product Main",
      "category": "saltbone"
    }
  ]
}
{% endschema %}

{% stylesheet %}
  section.product-main {
    padding: 85px 45px;
    .content-wrapper {
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
      gap: 65px;

      .product-images {
        width: 45%;
        .media-wrapper {
          aspect-ratio: .85;
          margin-bottom: 45px;

          img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
          }
        }

        .swiper {
          max-width: 400px;
          margin: 0 auto;

          .slide-wrapper {
            aspect-ratio: 1;
            cursor: pointer;
            img {
              width: 100%;
              height: 100%;
              object-fit: cover;
              object-position: center;
            }
          }
        }

        .media-controls {
          position: relative;
          width: 500px;
          margin: 0 auto;
          .swiper-button-prev {
            left: 0;
            &:after {
              color: #5f6368;
              font-weight: 800;
              font-size: 22px;
            }
          }

          .swiper-button-next {
            right: 0;
            &:after {
              color: #5f6368;
              font-weight: 800;
              font-size: 22px;
            }
          }
        }
      }

      .product-info {
        width: 55%;
        h1 {
          font-size: 26px;
          text-transform: uppercase;
          margin-bottom: 10px;
          letter-spacing: 1px;
        }

        .price-wrapper {
          display: flex;
          align-items: flex-end;
          gap: 10px;
          margin-bottom: 25px;

          h3.price {
            font-size: 34px;
            line-height: 34px;
            margin: 0;
          }

          h4 {
            font-size: 22px;
            margin: 0;
            position: relative;
            bottom: 2px;            
          }
        }

        .bottlenexus-wrapper {
          iframe {
            margin: 0 !important;
          }
        }

        .description {
          margin-top: 25px;

          p, li, a {
            font-size: 18px;
          }
        }
      }
    }

    @media (max-width: 1400px) {
      .content-wrapper {
        gap: 25px;
        .product-images {
          width: 50%;
          .swiper {
            max-width: 250px;
          }
          .media-controls {
            width: 350px;
          }
        }

        .product-info {
          width: 50%;
        }
      }
    }

    @media (max-width: 1024px) {
      padding: 65px 25px;
    }

    @media (max-width: 768px) {
      padding: 45px 25px;
      .content-wrapper {
        flex-direction: column;
        gap: 55px;

        .product-images {
          width: 100%;
          max-width: 450px;
          margin: 0 auto;
        }

        .product-info {
          width: 100%;
        }
      }
    }
  }
{% endstylesheet %}

{% javascript %}
  document.addEventListener('DOMContentLoaded', function() {
    var mediaImg = document.querySelector('.product-main .media-wrapper img');
    var swiper = new Swiper('.product-main .swiper', {
      slidesPerView: 3,
      spaceBetween: 10,
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },

    });

    // Update main image only on click
    var slideImgs = document.querySelectorAll('.product-main .swiper-slide img');
    slideImgs.forEach(function(img) {
      img.addEventListener('click', function() {
        if (mediaImg) {
          mediaImg.src = this.src;
          mediaImg.alt = this.alt;
        }
      });
    });

    // Make sure main image matches featured on load
    var firstSlideImg = document.querySelector('.product-main .swiper-slide img');
    if (firstSlideImg && mediaImg) {
      mediaImg.src = firstSlideImg.src;
      mediaImg.alt = firstSlideImg.alt;
    }
  });
{% endjavascript %}
